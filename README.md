# edge-ptz-setup

## 개요

이 저장소는 Edge PTZ DualCam 카메라 시스템을 라즈베리파이 기반 환경에서 제어하고, 카메라 프리뷰 및 팬틸트 모터를 UART로 제어하는 다양한 스크립트를 제공합니다.

---

## 스크립트 설명

### 1. add_com5_config, configure_eth1

- **용도**: `cm5` 보드에 라즈베리파이 OS를 새로 설치했을 때만 한 번 실행하면 되는 설정 스크립트입니다.
- **설명**: 카메라 연결, UART 등 하드웨어 환경 구성을 자동화합니다.
- **비고**: 제품에 이미 환경 구성이 되어 있으므로 따로 실행할 필요 없습니다.

### 2. run_picam.sh

- **용도**: 라즈베리파이 공식 카메라 모듈의 프리뷰(영상 미리보기)를 띄워주는 스크립트입니다.
- **설명**: 라즈베리파이 카메라가 정상적으로 연결되고 동작하는지 확인할 때 사용합니다.

### 3. run_zoomcamera

- **용도**: 줌 카메라를 ffmpeg를 이용해 프리뷰하는 스크립트입니다.
- **설명**: 화상 확인 및 테스트에 사용할 수 있습니다.
- **참고**: 줌 카메라의 줌이나 기타 제어는 이 스크립트에서는 제공하지 않으며, ONVIF 표준을 따라 제어할 수 있습니다.

### 4. pantilt.py

- **용도**: 팬/틸트 모터를 UART로 직접 제어하는 파이썬 스크립트입니다.
- **포트 정보**
  - `ttyAMA0`: 팬(좌우) 모터
  - `ttyAMA2`: 틸트(상하) 모터
- **제어 방식**
  - 각 모터의 속도 등 초기 셋업 후, `R` 명령어를 보내 모터를 꺼줍니다.
    - 주의: 모터가 꺼져 있어도, 프로그램 시작 전에 한 번 더 `R`을 보내 꺼주는 것이 안전합니다.
  - 약 1초 정도 대기 후, `S` 명령어를 보내 모터를 시작합니다.
  - 또 1초 정도 대기 후, `T`와 함께 각도를 보내면 해당 각도로 이동합니다.
    - 이때, 원하는 각도를 가끔 한 번씩 명령해도 되고, 예제처럼 100Hz 주기로 계속 보내면서 실시간 제어할 수도 있습니다.
  - 종료 시에는 다시 `R` 명령어를 보내 모터를 꺼주는 것이 좋습니다.

---

## 참고 사항

- 팬/틸트/줌 카메라와 관련된 ONVIF 표준 제어는 별도 구현되어 있지 않습니다. ONVIF 규격에 따라 직접 제어 코드를 작성하거나, 관련 라이브러리를 활용하세요. 초기 암호와 비밀번호는 admin/EdgePTZ#2025 입니다.
- 모든 스크립트 실행 전, 하드웨어 연결 상태(특히 UART 및 카메라 연결)를 반드시 확인하세요.

---

## 예시 사용법

```bash
# 라즈베리파이 카메라 프리뷰 실행
./run_picam.sh

# 줌 카메라 프리뷰 실행
./run_zoomcamera

# 팬/틸트 모터 제어
python3 pantilt.py
```

---

## 문의

질문이나 이슈는 GitHub Issue로 남겨주세요.
